var perf=angular.module("performance",[]);perf.directive("performance",[function(){return{restrict:"A",link:function(e,n,r){var i=(new Date).getTime();var t=[];e.$on("PERF_DONE",function(e,n){var i=t.indexOf(n);if(i>=0)t.splice(i,1);if(i>=0&&t.length==0){var o=0;var a=0;if(window.performance){o=(new Date).getTime()-window.performance.timing.domComplete;a=window.performance.timing.domComplete-window.performance.timing.fetchStart}a=!a||a<0?0:a;o=!o||o<0?0:o;var c=new Image;c.src=r.performanceBeacon+"?content="+o+"&initial="+a+"&name="+r.performance}});e.$on("PERF_REGISTER",function(e,n){t.push(n)})}}}]);perf.directive("performanceLoaded",["$timeout",function(e){return{restrict:"A",link:function(n,r,i){e(function(){n.$emit("PERF_REGISTER",n.$id)},0);var t=n.$watch(i.performanceLoaded,function(e,r){if(e){n.$emit("PERF_DONE",n.$id);t()}})}}}]);